# Runbook واکنش به رخداد امنیتی

## هدف
این سند مراحل واکنش استاندارد برای رخدادهای امنیتی مرتبط با سرویس UniqueMemory را شرح می‌دهد تا تیم‌ها در کمترین زمان رخداد را مهار و اثرات آن را کاهش دهند.

## تشخیص اولیه
- اعلان‌های SIEM، هشدارهای SentinelOne یا گزارش‌های مشتری را در Slack کانال `#sec-incidents` ثبت کنید.
- یک Incident Commander (IC) از میان اعضای تیم امنیت تعیین و در گردش کار PagerDuty فعال کنید.
- سطح شدت را مطابق طبقه‌بندی زیر مشخص کنید:
  - **Sev1:** نفوذ تایید‌شده یا افشای داده مشتری.
  - **Sev2:** تلاش نفوذ فعال یا سوءپیکربندی حساس.
  - **Sev3:** هشدارهای مشکوک نیازمند بررسی.

## مهار موقت
- IC دستور Block دسترسی مشکوک را با به‌روزرسانی Policy فایروال یا غیرفعال‌سازی Client ID در IAM صادر می‌کند.
- تیم زیرساخت Snapshot پایگاه داده و حافظه برداری را برای تحلیل پس از رخداد می‌گیرد.
- در صورت سوءاستفاده از کلید، کلیدهای OAuth2 را بلافاصله چرخش دهید.

## ریشه‌یابی و بازیابی
- لاگ‌های OpenTelemetry، Gateway و دیتابیس را استخراج و در پوشهٔ مشترک `incident-reports/<date>` ذخیره کنید.
- علت ریشه‌ای را با روش 5 Whys مستندسازی کرده و تغییرات لازم برای رفع دائمی را در `docs/backlog.md` ثبت کنید.
- پس از اعمال اصلاحات، سرویس تحت تاثیر را با مانیتورینگ تقویت‌شده به محیط تولید برگردانید.

## ارتباطات
- گزارش اولیه ظرف 60 دقیقه در Confluence صفحهٔ `Security Incidents` ثبت شود.
- در صورت تاثیر بر مشتری، اطلاع‌رسانی رسمی از طریق تیم موفقیت مشتری ظرف 24 ساعت انجام شود.
- پس از خاتمه، جلسهٔ Postmortem با حضور تیم‌های امنیت، زیرساخت و محصول برگزار کنید.

## مستندسازی تکمیلی
- ضمایم مربوط به Artefactها، نمودار زمان‌بندی و درس‌آموخته‌ها را ظرف 72 ساعت اضافه کنید.
- کارت‌های پیگیری را در Jira پروژهٔ `SEC` با برچسب `incident` بسازید و مالک هر اقدام را تعیین کنید.

